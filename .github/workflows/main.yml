name: Test Server Connection
on:
  push:
    branches:
      - main
jobs:
  test_connection:
    runs-on: ubuntu-latest
    steps:
    - name: Install netcat
      run: sudo apt-get update && sudo apt-get install -y netcat

    - name: Test connection
      env:
        HOST: ${{ secrets.FTP_SERVER }}
        PORT: ${{ secrets.FTP_PORT }}
      run: |
        echo "Testing connection to $HOST:$PORT"
        nc -zv -w 10 $HOST $PORT
        
    - name: Test SSH connection
      env:
        HOST: ${{ secrets.FTP_SERVER }}
        USER: ${{ secrets.FTP_USERNAME }}
        PORT: ${{ secrets.FTP_PORT }}
      run: |
        echo "Testing SSH connection to $HOST:$PORT"
        ssh -o ConnectTimeout=10 -o StrictHostKeyChecking=no -p $PORT $USER@$HOST echo "Connection successful"
      continue-on-error: true
